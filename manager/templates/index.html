<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mihomo Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --bg-body: #f4f6f9;
            --bg-sidebar: #fff;
            --bg-card: #fff;
            --text-main: #212529;
            --text-muted: #6c757d;
            --border-color: #e1e4e8;
            --input-bg: #fff;
            --log-bg: #1e1e1e;
        }

        /* 黑暗模式变量 */
        [data-theme="dark"] {
            --bg-body: #121212;
            --bg-sidebar: #1e1e1e;
            --bg-card: #252525;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --border-color: #333;
            --input-bg: #2b2b2b;
            --log-bg: #000;
        }

        body { background-color: var(--bg-body); color: var(--text-main); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; transition: background-color 0.3s; }
        .sidebar { background: var(--bg-sidebar); min-height: 100vh; padding: 20px; border-right: 1px solid var(--border-color); width: 260px; position: fixed; z-index: 1000; transition: background-color 0.3s; }
        .content-area { margin-left: 260px; padding: 30px; }
        
        /* 导航 */
        .nav-link { color: var(--text-muted); margin-bottom: 8px; border-radius: 8px; font-weight: 500; padding: 12px; transition: all 0.2s; cursor: pointer; }
        .nav-link:hover { background-color: rgba(13, 110, 253, 0.1); color: #0d6efd; }
        .nav-link.active { background-color: #0d6efd !important; color: #fff !important; box-shadow: 0 4px 6px rgba(13, 110, 253, 0.3); }
        .nav-link i { margin-right: 12px; font-size: 1.1em; }

        /* 卡片 */
        .card { border: 1px solid var(--border-color); box-shadow: 0 4px 12px rgba(0,0,0,0.03); margin-bottom: 24px; border-radius: 12px; background: var(--bg-card); color: var(--text-main); transition: background-color 0.3s; }
        .card-header { background: transparent; border-bottom: 1px solid var(--border-color); font-weight: 700; padding: 18px 20px; }
        
        /* 输入框 & 按钮 */
        .form-control { background-color: var(--input-bg); border-color: var(--border-color); color: var(--text-main); }
        .form-control:focus { background-color: var(--input-bg); color: var(--text-main); border-color: #0d6efd; }
        .form-label { color: var(--text-muted); font-size: 0.9em; margin-bottom: 0.3rem; }
        
        /* 日志样式优化 (仿 Infuse/Emby) */
        .log-box { 
            background: var(--log-bg); 
            font-family: 'JetBrains Mono', 'Consolas', monospace; 
            height: 650px; 
            overflow-y: auto; 
            padding: 15px; 
            border-radius: 8px; 
            font-size: 12px; 
            line-height: 1.6; 
            border: 1px solid var(--border-color);
        }
        .log-entry { margin-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 2px; display: flex; align-items: flex-start; }
        .log-time { color: #888; margin-right: 10px; min-width: 130px; }
        .log-tag { padding: 1px 6px; border-radius: 4px; font-weight: bold; margin-right: 10px; font-size: 11px; display: inline-block; min-width: 50px; text-align: center; }
        .tag-info { background: #198754; color: #fff; } /* Green */
        .tag-warn { background: #ffc107; color: #000; } /* Yellow */
        .tag-error { background: #dc3545; color: #fff; } /* Red */
        .tag-debug { background: #6c757d; color: #fff; } /* Grey */
        .log-msg { color: #dcdcdc; word-break: break-all; }

        /* 编辑器 */
        textarea#config-editor { font-family: 'Consolas', monospace; font-size: 13px; background-color: var(--input-bg); color: var(--text-main); border: none; }
    </style>
</head>
<body>

<div class="sidebar d-flex flex-column">
    <div class="d-flex justify-content-between align-items-center mb-5 px-2">
        <h3 class="fw-bold text-primary m-0"><i class="bi bi-hdd-network"></i> Mihomo</h3>
        <button class="btn btn-sm btn-outline-secondary border-0" onclick="toggleTheme()" title="切换深色模式">
            <i class="bi bi-moon-stars-fill" id="theme-icon"></i>
        </button>
    </div>
    
    <div class="nav flex-column nav-pills me-3" id="mainTab" role="tablist">
        <button class="nav-link active" id="tab-dash-btn" data-bs-toggle="pill" data-bs-target="#tab-dash"><i class="bi bi-grid-1x2"></i> 概览与控制</button>
        <button class="nav-link" id="tab-tasks-btn" data-bs-toggle="pill" data-bs-target="#tab-tasks" onclick="loadSettings()"><i class="bi bi-sliders"></i> 订阅与任务</button>
        <button class="nav-link" id="tab-notify-btn" data-bs-toggle="pill" data-bs-target="#tab-notify" onclick="loadSettings()"><i class="bi bi-bell"></i> 通知中心</button>
        <button class="nav-link" id="tab-logs-btn" data-bs-toggle="pill" data-bs-target="#tab-logs" onclick="loadLogs()"><i class="bi bi-terminal"></i> 运行日志</button>
    </div>
    <div class="mt-auto text-muted small ps-2">v2.4 Pro | <span id="ver-info">LXC</span></div>
</div>

<div class="content-area">
    <div class="tab-content">
        <div class="tab-pane fade show active" id="tab-dash
